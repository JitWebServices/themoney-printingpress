---
import { getCollection } from 'astro:content';

// Get recent posts from content collection
const allPosts = await getCollection('blog');
const recentPosts = allPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3); // Get the 3 most recent posts

// Helper function to create proper URLs
const getUrl = (path: string) => {
  const base = import.meta.env.BASE_URL || '/';
  return base === '/' ? path : base + path;
};
---

<div style="display: grid; grid-template-columns: 1fr 350px; gap: 0; max-width: 1400px; margin: 0 auto; flex: 1;">

	<!-- Left Column - Main Content -->
	<div style="background-color: #f6f2ea;">

		<!-- Hero Section -->
		<section style="position: relative; height: 350px; overflow: hidden;">
			<img
			  src={getUrl('/images/home-page-hero.jpg')}
			  alt="Early world map symbolizing historical trade and wealth"
			  style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; filter: brightness(0.7);"
			/>
			<div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3);"></div>

			<div style="position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 20px; text-align: center;">
				<h1 style="font-family: 'Playfair Display', serif; font-size: 22px; margin-bottom: 20px; color: #f6f2ea; max-width: 800px; line-height: 1.5;">
					The Moneyâ€‘Printing Press uncovers the recurring patterns inside stories of merchants,
					empires, and marketsâ€”how fortunes were built, defended, and lost. Each issue distills a
					single principle you can use now.
				</h1>
				<div style="width: 80px; height: 3px; background: #B08A30; margin-bottom: 20px;"></div>
				<p style="font-family: 'Playfair Display', serif; font-size: 20px; color: #f6f2ea; max-width: 600px;">
					Join early readers for one focused historical finance lesson each week.
				</p>
			</div>
		</section>

		<!-- Latest Posts Section -->
		<section style="padding: 60px 40px; background-color: #FBF9F4;">
			<h2 style="font-family: 'Playfair Display', serif; font-size: 36px; font-weight: 600; margin-bottom: 40px; color: #2F4858;">
				Latest Insights
			</h2>

			<div style="display: flex; flex-direction: column; gap: 30px; margin-bottom: 40px;">
				{recentPosts.map((post) => (
					<div style="border-bottom: 1px solid #e5e7eb; padding-bottom: 30px;">
						<div style="padding: 15px;">
							<a href={getUrl(`/blog/${post.slug}`)} style="text-decoration: none;">
								<div style="display: flex; flex-direction: column; gap: 12px;">
									<h2 style="font-size: 28px; color: #2F4858; font-family: 'Playfair Display', serif;">
										{post.data.title}
									</h2>
									<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px;">
										{post.data.tags.map((tag) => (
											<span style="background-color: #f9f9f9; border: 2px solid #d4af37; color: #7f1d1d; padding: 4px 12px; border-radius: 20px; font-size: 14px;">
												{tag}
											</span>
										))}
									</div>
									<p style="color: #6b7280; padding: 8px 0; margin-bottom: 8px;">
										{post.data.date.toLocaleDateString("en-US", {
											year: "numeric",
											month: "long",
											day: "numeric",
										})}
									</p>
									<div style="color: #374151; font-size: 18px; line-height: 1.6;">
										{post.data.description}
									</div>
								</div>
							</a>
						</div>
					</div>
				))}
			</div>

			<div style="text-align: center;">
				<a
					href={getUrl('/archive')}
					style="display: inline-block; color: white; font-weight: 600; padding: 12px 32px; border-radius: 8px; background: linear-gradient(135deg, #9e383d, #7f1d1d); text-decoration: none; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"
					onmouseover="this.style.transform='translateY(-2px)'"
					onmouseout="this.style.transform='translateY(0)'"
				>
					View All Posts
				</a>
			</div>
		</section>
	</div>

	<!-- Right Column - Mini About Sidebar -->
	<div style="background-color: #f6f2ea; padding: 40px 30px;">
		<div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: sticky; top: 20px;">
			<div style="text-align: center; margin-bottom: 20px;">
				<div style="width: 120px; height: 120px; margin: 0 auto 15px; background: linear-gradient(135deg, #d1d5db, #9ca3af); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
					<span style="font-size: 60px;">ðŸ“¸</span>
				</div>
				<h3 style="font-family: 'Playfair Display', serif; font-size: 24px; font-weight: 600; color: #2F4858; margin-bottom: 5px;">
					Marcos Vega
				</h3>
				<p style="color: #6b7280; font-size: 14px; font-style: italic;">
					Author
				</p>
			</div>

			<p style="color: #374151; font-size: 16px; line-height: 1.7; margin-bottom: 20px;">
				A Cuban-born statistics student and aspiring financial advisor with a growing obsession in answering the question "What lessons does history hide?"
			</p>

			<div style="margin-bottom: 20px;">
				<a href={getUrl('/about')} style="display: block; width: 100%; text-align: center; color: white; font-weight: 600; padding: 10px; border-radius: 6px; background: linear-gradient(135deg, #9e383d, #7f1d1d); text-decoration: none; margin-bottom: 10px;">
					Read More About Me
				</a>
			</div>

			<div style="border-top: 1px solid #e5e7eb; padding-top: 20px;">
				<h4 style="font-family: 'Playfair Display', serif; font-size: 16px; font-weight: 600; color: #2F4858; margin-bottom: 12px;">
					Connect
				</h4>
				<div style="display: flex; flex-direction: column; gap: 8px;">
					<a href="https://www.linkedin.com/in/marcos-vega-7t/" target="_blank" style="color: #9e383d; text-decoration: none; font-size: 14px;">â†’ LinkedIn</a>
					<a href="https://www.instagram.com/marcos.mvega/" target="_blank" style="color: #9e383d; text-decoration: none; font-size: 14px;">â†’ Instagram</a>
					<a href="https://www.goodreads.com/user/show/109021563-marcos" target="_blank" style="color: #9e383d; text-decoration: none; font-size: 14px;">â†’ Goodreads</a>
				</div>
			</div>
		</div>
	</div>

</div>