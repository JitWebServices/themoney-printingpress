---
import { getCollection } from 'astro:content';

// Get recent posts from content collection
const allPosts = await getCollection('blog');
const recentPosts = allPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3); // Get the 3 most recent posts
---

<div class="max-w-screen-xl shadow-2xl mx-auto flex-1 text-slate-900" style="background-color: #f6f2ea;">
	
	<!-- Hero Section - Fixed height and positioning -->
	<section class="relative h-[500px] overflow-hidden">
		<img
		  src="/images/home-page-hero.jpg"
		  alt="Early world map symbolizing historical trade and wealth"
		  class="absolute inset-0 w-full h-full object-cover object-center"
		  style="filter: contrast(1.05) brightness(0.92);"
		  loading="lazy"
		  decoding="async"
		  onerror="this.style.display='none'; this.parentElement.style.background='linear-gradient(135deg, #9C272E 0%, #B83339 25%, #9C272E 50%, #B83339 75%, #9C272E 100%)';"
		/>
		<!-- Enhanced overlay for better text readability -->
		<div class="absolute inset-0 bg-gradient-to-b from-black/20 via-black/10 to-black/20"></div>
	  
		<!-- Centered content with adjusted positioning -->
		<div class="relative z-10 flex flex-col items-center justify-center h-full px-6 text-center">
		  <!-- Main body positioned higher -->
		  <div class="transform -translate-y-18">
			<h1 class="font-serif tracking-tight text-lg md:text-2xl mb-6 text-[#f6f2ea] ">
				The Money‑Printing Press uncovers the recurring patterns inside stories of merchants,
				empires, and markets—how fortunes were built, defended, and lost. Each issue distills a
				single principle you can use now.
			</h1>
			<div class="w-20 h-[3px] bg-[#B08A30] mb-8 mx-auto"></div>
		  </div>
		  
		  <!-- subscriber -->
		  <div class="max-w-lg mx-auto px-4 -translate-y-20">
			<p class="font-serif text-lg md:text-xl leading-relaxed text-[#f6f2ea] tracking-wide text-center ">
				Join early readers for one focused historical finance lesson each week.
			</p>
		  </div>
		</div>
	  
		<!-- Subtle bottom fade -->
		<div class="absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-black/30 to-transparent pointer-events-none"></div>
	</section>

	<!-- Latest Posts Section -->
	<section class="py-20" style="background-color: #FBF9F4;">
		<div class="container mx-auto px-6 max-w-6xl">
			<h2 class="text-4xl font-semibold mb-12 text-center victoria-font"
				style="font-family: 'Victoria', 'Times New Roman', serif; color: #2F4858;">
				Latest Insights
			</h2>
			
			<div class="grid md:grid-cols-1 gap-8 mb-12">
				{recentPosts.map((post) => (
					<div class="border-b border-gray-200 pb-8 last:border-b-0">
						<div class="p-4 mx-auto">
							<a href={`/blog/${post.slug}`} class="font-semibold">
								<div class="flex flex-col gap-3">
									<h2 class="text-3xl hover:text-slate-900 transition-colors duration-200"
										style="hover:color: #9e383d;">
										{post.data.title}
									</h2>
									<div class="flex flex-wrap gap-2 mb-2">
										{post.data.tags.map((tag) => (
											<span class="text-gray-700 px-3 py-1 rounded-full text-sm border-2"
												  style="background-color: #f9f9f9; border-color: #d4af37; color: #7f1d1d;">
												{tag}
											</span>
										))}
									</div>
									<p class="text-gray-500 border-t-1 border-b-1 border-gray-300 py-2 mb-2">
										{post.data.date.toLocaleDateString("en-US", {
											year: "numeric",
											month: "long", 
											day: "numeric",
										})}
									</p>
									<div class="text-gray-700 text-xl leading-relaxed">
										{post.data.description}
									</div>
								</div>
							</a>
						</div>
					</div>
				))}
			</div>
			
			<div class="text-center">
				<a
					href="/archive"
					class="inline-block text-white font-semibold px-8 py-3 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl"
					style="background: linear-gradient(135deg, #9e383d, #7f1d1d);"
					onmouseover="this.style.transform='translateY(-2px)'"
					onmouseout="this.style.transform='translateY(0)'"
				>
					View All Posts
				</a>
			</div>
		</div>
	</section>
</div>